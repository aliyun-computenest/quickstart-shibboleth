# docker-compose.yml
version: "3.8"

services:
  mariadb:
    image: mariadb:10.11
    environment:
      MARIADB_DATABASE: shibboleth
      MARIADB_USER: shibboleth
      MARIADB_PASSWORD: dbpassword123
      MARIADB_ROOT_PASSWORD: rootpassword123
    volumes:
      - db_data:/var/lib/mysql
    networks:
      - idp-net

  shib-idp:
    image: shibboleth-idp:5.2  # 使用本地构建的镜像
    ports:
      - "8443:8443"
    environment:
      IDP_HOSTNAME: idp.example.com  # ← 替换为你的域名
    volumes:
      - idp_data:/opt/shibboleth-idp
    depends_on:
      - mariadb
    networks:
      - idp-net

volumes:
  db_data:
  idp_data:

networks:
  idp-net:
    driver: bridge
